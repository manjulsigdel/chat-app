extends layout

block content
    .row
        .col-md-5
            .panel.panel-primary
                .panel-heading
                    span.glyphicon.glyphicon-comment
                    |  Chat
                    .btn-group.pull-right
                        button.btn.btn-default.btn-xs.dropdown-toggle(type='button', data-toggle='dropdown')
                            span.glyphicon.glyphicon-chevron-down
                        ul.dropdown-menu.slidedown
                            li
                                a(href='#')
                                span.glyphicon.glyphicon-refresh
                                | Refresh
                            li
                                a(href='#')
                                span.glyphicon.glyphicon-ok-sign
                                | Available
                            li
                                a(href='#')
                                span.glyphicon.glyphicon-remove
                                | Busy
                            li
                                a(href='#')
                                span.glyphicon.glyphicon-time
                                | Away
                            li.divider
                            li
                                a(href='#')
                                span.glyphicon.glyphicon-off
                                | Sign Out
                .panel-body
                    ul.chat
                .panel-footer
                .input-group
                    form(action="")
                        input#btn-input.form-control.input-sm(type='text', placeholder='Type your message here...')
                        span.input-group-btn
                            button#btn-chat.btn.btn-warning.btn-sm
                                | Send
block script     
    script(src='/socket.io/socket.io.js')
    script.
        $(function () {
            var socket = io();
            socket.on('status message', function(msg){
                $('.chat').append('<li>'+ msg +'</li>')
            });
            socket.emit('status message', "#{ user.name }");
            $('form').submit(function(){
                var typedMessage = $('#btn-input').val();
                console.log(typedMessage);
                $('.chat').append('<li class="right clearfix"><span class="chat-img pull-right"><img class="img-circle" src="http://placehold.it/50/FA6F57/fff&amp;text=BP" alt="User Avatar"></span><div class="chat-body clearfix"><div class="header"><small class="text-muted"><span class="glyphicon glyphicon-time"></span>13 mins ago</small><strong class="pull-right primary-font">You</strong></div><p>'+ typedMessage +'</p></div></li>');                
                socket.emit('chat message', $('#btn-input').val());
                $('#btn-input').val('');
                return false;
            });
            socket.on('chat message', function(msg){
                $('.chat').append('<li class="left clearfix"><span class="chat-img pull-left"><img class="img-circle" src="http://placehold.it/50/55C1E7/fff&amp;text=JS" alt="User Avatar"></span><div class="chat-body clearfix"><div class="header"><strong class="primary-font">#{user.name}</strong><small class="pull-right text-muted"><span class="glyphicon glyphicon-time"></span>12 mins ago</small></div><p>'+ msg +'</p></div></li>');
            });
        });
